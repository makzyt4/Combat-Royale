#include "JsonLoader.hpp"


picojson::value* cr::JsonLoader::loadFromFile(const std::string& filename) {
    std::string fullPath = "../res/json/" + path;

    std::map<std::string, std::string*>::iterator it = this->jsonMap.find(fullPath);
    std::string* jsonText = new std::string();


    std::ifstream t(filename);
    std::stringstream buffer;

    if (t) {
        buffer << t.rdbuf();
    } else {
        std::cerr << "Error: Could not open JSON file \"" << fullPath << "\"" << std::endl;
    }

    return cr::JsonLoader::loadFromString(buffer.str());
}

picojson::value* cr::JsonLoader::loadFromString(const std::string& text) {
    auto v = new picojson::value();

    std::string err = picojson::parse(*v, text);

    if (!err.empty()) {
        std::cerr << err << std::endl;
        return nullptr;
    }

    return v;
}
